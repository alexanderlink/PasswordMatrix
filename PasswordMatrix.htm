<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->
<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
  <style>
  body {
    font-size: 16pt;
    font-weight: bolder;
    font-family: "Lucida Console", Monaco, monospace;
  }
  #full {
    font-size: 14pt;
    border-style: solid;
    border-width: 1px;
  }
  #textarea, textareaExcel {
    font-size: 14pt;
    width: 280px;
    height: 280px;
    border-style: solid;
    border-width: 1px;
  }
  .cell {
    vertical-align: middle;
    text-align: center;
    border-style: solid;
    border-width: 1px;
    border-color: #ddd;
    width: 14.2857142857%;
    height: 14.2857142857%;
  }
  .col {
    font-size: 24pt;
    vertical-align: middle;
    text-align: center;
    border-style: none;
    width: 100%;
    height: 100%;
  }
  .col0 {
    background-color: #ffffff;
  }
  .col1 {
    background-color: #f0f0f0;
  }
  </style>
  <title>ALX Password Matrix</title>
</head>
<body>
<div class="container">

  <div class="row">
    <div class="col-md-12">
      <h1>ALX Password Matrix</h1>
    </div>
  </div>

  <div class="row">
      <textarea id="full" class="col-xs-12"></textarea>
      <br/><br/><br/>
  </div>

  <div class="row">
  
    <div class="col-sm-12" id="matrixContainer">
      <div id="matrix" class="container-fluid matrix"></div>
      <br/>
    </div>
  
    <div class="row">
      <button class="btn btn-success" id="0-9">0-9</button>	
      <button class="btn btn-success" id="A-Z">A-Z</button>
      <button class="btn btn-success" id="A-Za-z">A-Za-z</button>
      <button class="btn btn-success" id="A-Za-z0-9">A-Za-z0-9</button>
      <button class="btn btn-success" id="A-Za-z0-9Sonder">A-Za-z0-9$?%</button>
      <button type="button" class="btn btn-info" data-toggle="collapse" data-target="#textareadiv">Matrix as text</button>
    </div>
    <br/>
  </div>
  
  <div id="textareadiv" class="row collapse">
    <div  class="col-sm-3">
      <textarea id="textarea" readonly cols="30" rows="7"></textarea>
	</div>
    <div  class="col-sm-9">
      <textarea id="textareaExcel" readonly cols="60" rows="7"></textarea>
    </div>
  </div>
  
</div>

  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
  
    <script>
    function random(nr, chars) {
      var result = "";
      for(var i = 0; i < nr; i++) {
        result += chars.charAt(Math.floor((Math.random() * chars.length)));
      }
      $('#full').val(result);
      inputFieldChanged();
    }
    
    function matrixChanged() {
      updateInputField();
      populateTextArea();
    }    

    function inputFieldChanged() {
      populateMatrix();
      populateTextArea();
    }    
    
    function updateInputField() {
      var full = $('#full');
      full.val('');
      for(var i = 0; i < 1000; i++) {
        var cell = $('#col'+i);
        if(cell.length <= 0) break;
        if(!cell.val()) alert("No value in cell " + i);
        full.val(full.val() + cell.val());
      }
    }
    
    function populateMatrix() {
      var full = $('#full');
      var matrix = $('#matrix');
      matrix.empty();
      var fullText = full.val();
      var table = $("<table>", {id: "table", class: "table"});
      matrix.append(table);
      for (var i = 0; i < fullText.length; i++) {
        if(i % 7 == 0) {
          var row = $("<tr>", {id: "row"+i, class: "row"});
          table.append(row);
        }
        var cell = $("<td>", {id: "cell"+i, class: "cell col" + i%2});
        var cellInput = $("<input>", {maxlength: "1", id: "col"+i, class: "col col" + i%2});
        cellInput.val(fullText[i]);
        cellInput.keyup(matrixChanged);
        cellInput.click(function(e) {e.target.select()});
        cell.append(cellInput);
        row.append(cell);
      }
      resizeMatrix();
    }
    
    function resizeMatrix() {
      var w = $("#matrixContainer").width();
      var s = $(document).height() - 400;
      var w = Math.min(w, s);
      $("#table").css("width", w);
      $("#table").css("height", w);
      //$(window).resize(resizeMatrix);
    }
    
    function populateTextArea() {
      var full = $('#full');
      var textarea = $('#textarea');
      textarea.val('');
      var fullText = full.val();
      for (var i = 0; i < fullText.length; i++) {
        if(i > 0 && i % 7 == 0) {
          textarea.val(textarea.val() + '\n');
        } else if(textarea.val().length > 0) {
		  textarea.val(textarea.val() + ' ');
		}
        textarea.val(textarea.val() + fullText[i]);
        textarea.click(function(e) {e.target.select()});
      }
	  populateTextAreaExcel();
    }

    function populateTextAreaExcel() {
      var full = $('#full');
      var textarea = $('#textareaExcel');
      textarea.val('');
      var fullText = full.val();
      for (var i = 0; i < fullText.length; i++) {
        if(i > 0 && i % 7 == 0) {
          textarea.val(textarea.val() + '\n');
        } else if(textarea.val().length > 0) {
		  textarea.val(textarea.val() + '\t');
		}
		var c = fullText[i];
		if(c === '\"') {
			textarea.val(textarea.val() + '=""""');
		} else {
			textarea.val(textarea.val() + '="' + c + '"');
		}
        textarea.click(function(e) {e.target.select()});
      }
    }
	
	
    
    $(function(){
      $('#full').val('');
      for(var i = 0; i < 49; i++) $('#full').val($('#full').val() + ' ');
      populateMatrix();
      populateTextArea();
      $('#full').keyup(inputFieldChanged);
      $('#full').click(function(e) {e.target.select()});
      $('#0-9').click(function() { random(49, "0123456789"); });
      $('#A-Z').click(function() { random(49, "ABCDEFGHIJKLMNOPQRSTUVWXYZ"); });
      $('#A-Za-z').click(function() { random(49, "ABCDEFGHJKLMNOPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"); });
      $('#A-Za-z0-9').click(function() { random(49, "ABCDEFGHJKLMNOPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz0123456789"); });
      $('#A-Za-z0-9Sonder').click(function() { random(49, "ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz123456789~!@#$%^&*()_-+={}[]\\:;\"'<>,.?/"); });
    });
  </script> 
  
</body>
</html>
